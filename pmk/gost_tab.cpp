/*************************************************
* S-Box Tables for GOST                          *
* (C) 1999-2001 The OpenCL Project               *
*************************************************/

#include "gost.h"

using namespace OpenCL;

	u32bit GOST::SBOX1[256];
	u32bit GOST::SBOX2[256];
	u32bit GOST::SBOX3[256];
	u32bit GOST::SBOX4[256];


	const char* GOST::OID[6] = {
	"1.2.643.2.2.31.0",
	"1.2.643.2.2.31.1",
	"1.2.643.2.2.31.2",
	"1.2.643.2.2.31.3",
	"1.2.643.2.2.31.4",
	"1.2.643.7.1.2.5.1.1"};

	const byte GOST::K[6][8][16] = 	{
	// S-блоки из контрольных тестов ГОСТ 28147-89
	// OID 1.2.643.2.2.31.0
	
	{{0x4,0x2,0xf,0x5,0x9,0x1,0x0,0x8,0xe,0x3,0xb,0xc,0xd,0x7,0xa,0x6},		//1
	{0xc,0x9,0xf,0xe,0x8,0x1,0x3,0xa,0x2,0x7,0x4,0xd,0x6,0x0,0xb,0x5},		//2		
	{0xd,0x8,0xe,0xc,0x7,0x3,0x9,0xa,0x1,0x5,0x2,0x4,0x6,0xf,0x0,0xb},		//3
	{0xe,0x9,0xb,0x2,0x5,0xf,0x7,0x1,0x0,0xd,0xc,0x6,0xa,0x4,0x3,0x8},		//4
	{0x3,0xe,0x5,0x9,0x6,0x8,0x0,0xd,0xa,0xb,0x7,0xc,0x2,0x1,0xf,0x4},		//5
	{0x8,0xf,0x6,0xb,0x1,0x9,0xc,0x5,0xd,0x3,0x7,0xa,0x0,0xe,0x2,0x4},		//6
	{0x9,0xb,0xc,0x0,0x3,0x6,0x7,0x5,0x4,0x8,0xe,0xf,0x1,0xa,0x2,0xd},		//7
	{0xc,0x6,0x5,0x2,0xb,0x0,0x9,0xd,0x3,0xe,0x7,0xa,0xf,0x4,0x1,0x8}},		//8
	
	// Узелы замен из RFC 4357
	// OID 1.2.643.2.2.31.1
	// id-Gost28147-89-CryptoPro-A-ParamSet
	{{0x9,0x6,0x3,0x2,0x8,0xB,0x1,0x7,0xA,0x4,0xE,0xF,0xC,0x0,0xD,0x5},		//1
	{0x3,0x7,0xE,0x9,0x8,0xA,0xF,0x0,0x5,0x2,0x6,0xC,0xB,0x4,0xD,0x1},		//2
	{0xE,0x4,0x6,0x2,0xB,0x3,0xD,0x8,0xC,0xF,0x5,0xA,0x0,0x7,0x1,0x9},		//3
	{0xE,0x7,0xA,0xC,0xD,0x1,0x3,0x9,0x0,0x2,0xB,0x4,0xF,0x8,0x5,0x6},		//4
	{0xB,0x5,0x1,0x9,0x8,0xD,0xF,0x0,0xE,0x4,0x2,0x3,0xC,0x7,0xA,0x6},		//5
	{0x3,0xA,0xD,0xC,0x1,0x2,0x0,0xB,0x7,0x5,0x9,0x4,0x8,0xF,0xE,0x6},		//6
	{0x1,0xD,0x2,0x9,0x7,0xA,0x6,0x0,0x8,0xC,0x4,0x5,0xF,0x3,0xB,0xE},		//7
	{0xB,0xA,0xF,0x5,0x0,0xC,0xE,0x8,0x6,0x2,0x3,0x9,0x1,0x7,0xD,0x4}},		//8

	// Узелы замен из RFC 4357
	// OID 1.2.643.2.2.31.2
	// id-Gost28147-89-CryptoPro-B-ParamSet
	{{0x8,0x4,0xb,0x1,0x3,0x5,0x0,0x9,0x2,0xe,0xa,0xc,0xd,0x6,0x7,0xf},		//1
	{0x0,0x1,0x2,0xa,0x4,0xd,0x5,0xc,0x9,0x7,0x3,0xf,0xb,0x8,0x6,0xe},		//2
	{0xe,0xc,0x0,0xa,0x9,0x2,0xd,0xb,0x7,0x5,0x8,0xf,0x3,0x6,0x1,0x4},		//3
	{0x7,0x5,0x0,0xd,0xb,0x6,0x1,0x2,0x3,0xa,0xc,0xf,0x4,0xe,0x9,0x8},		//4
	{0x2,0x7,0xc,0xf,0x9,0x5,0xa,0xb,0x1,0x4,0x0,0xd,0x6,0x8,0xe,0x3},		//5
	{0x8,0x3,0x2,0x6,0x4,0xd,0xe,0xb,0xc,0x1,0x7,0xf,0xa,0x0,0x9,0x5},		//6
	{0x5,0x2,0xa,0xb,0x9,0x1,0xc,0x3,0x7,0x4,0xd,0x0,0x6,0xf,0x8,0xe},		//7
	{0x0,0x4,0xb,0xe,0x8,0x3,0x7,0x1,0xa,0x2,0x9,0x6,0xf,0xd,0x5,0xc}},		//8

	// Узелы замен из RFC 4357
	// OID 1.2.643.2.2.31.3
	// id-Gost28147-89-CryptoPro-C-ParamSet
	{{0x1,0xb,0xc,0x2,0x9,0xd,0x0,0xf,0x4,0x5,0x8,0xe,0xa,0x7,0x6,0x3},		//1
	{0x0,0x1,0x7,0xd,0xb,0x4,0x5,0x2,0x8,0xe,0xf,0xc,0x9,0xa,0x6,0x3},		//2
	{0x8,0x2,0x5,0x0,0x4,0x9,0xf,0xa,0x3,0x7,0xc,0xd,0x6,0xe,0x1,0xb},		//3	
	{0x3,0x6,0x0,0x1,0x5,0xd,0xa,0x8,0xb,0x2,0x9,0x7,0xe,0xf,0xc,0x4},		//4
	{0x8,0xd,0xb,0x0,0x4,0x5,0x1,0x2,0x9,0x3,0xc,0xe,0x6,0xf,0xa,0x7},		//5
	{0xc,0x9,0xb,0x1,0x8,0xe,0x2,0x4,0x7,0x3,0x6,0x5,0xa,0x0,0xf,0xd},		//6
	{0xa,0x9,0x6,0x8,0xd,0xe,0x2,0x0,0xf,0x3,0x5,0xb,0x4,0x1,0xc,0x7},		//7
	{0x7,0x4,0x0,0x5,0xa,0x2,0xf,0xe,0xc,0x6,0x1,0xb,0xd,0x9,0x3,0x8}},		//8

	// Узелы замен из RFC 4357
	// OID 1.2.643.2.2.31.4
	// id-Gost28147-89-CryptoPro-D-ParamSet
	{{0xf,0xc,0x2,0xa,0x6,0x4,0x5,0x0,0x7,0x9,0xe,0xd,0x1,0xb,0x8,0x3},		//1
	{0xb,0x6,0x3,0x4,0xc,0xf,0xe,0x2,0x7,0xd,0x8,0x0,0x5,0xa,0x9,0x1},		//2
	{0x1,0xc,0xb,0x0,0xf,0xe,0x6,0x5,0xa,0xd,0x4,0x8,0x9,0x3,0x7,0x2},		//3
	{0x1,0x5,0xe,0xc,0xa,0x7,0x0,0xd,0x6,0x2,0xb,0x4,0x9,0x3,0xf,0x8},		//4
	{0x0,0xc,0x8,0x9,0xd,0x2,0xa,0xb,0x7,0x3,0x6,0x5,0x4,0xe,0xf,0x1},		//5
	{0x8,0x0,0xf,0x3,0x2,0x5,0xe,0xb,0x1,0xa,0x4,0x7,0xc,0x9,0xd,0x6},		//6
	{0x3,0x0,0x6,0xf,0x1,0xe,0x9,0x2,0xd,0x8,0xc,0x4,0xb,0xa,0x5,0x7},		//7
	{0x1,0xa,0x6,0x8,0xf,0xb,0x0,0x4,0xc,0x3,0x5,0x9,0x7,0xd,0x2,0xe}},		//8


	// S-блоки из Рекомендованных ТК26 Вариант 2
	// OID 1.2.643.7.1.2.5.1.1
	{{0xc,0x4,0x6,0x2,0xa,0x5,0xb,0x9,0xe,0x8,0xd,0x7,0x0,0x3,0xf,0x1},		//1
	{0x6,0x8,0x2,0x3,0x9,0xa,0x5,0xc,0x1,0xe,0x4,0x7,0xb,0xd,0x0,0xf},		//2
	{0xb,0x3,0x5,0x8,0x2,0xf,0xa,0xd,0xe,0x1,0x7,0x4,0xc,0x9,0x6,0x0},		//3
	{0xc,0x8,0x2,0x1,0xd,0x4,0xf,0x6,0x7,0x0,0xa,0x5,0x3,0xe,0x9,0xb},		//4
	{0x7,0xf,0x5,0xa,0x8,0x1,0x6,0xd,0x0,0x9,0x3,0xe,0xb,0x4,0x2,0xc},		//5
	{0x5,0xd,0xf,0x6,0x9,0x2,0xc,0xa,0xb,0x7,0x8,0x1,0x4,0x3,0xe,0x0},		//6
	{0x8,0xe,0x2,0x5,0x6,0x9,0x1,0xc,0xf,0x4,0xb,0x0,0xd,0xa,0x3,0x7},		//7
	{0x1,0x7,0xe,0xd,0x0,0x5,0x8,0x3,0x4,0xf,0xa,0x6,0x9,0xc,0xb,0x2}}};		//8